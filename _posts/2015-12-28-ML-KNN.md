---
layout: post
title: "K Nearest Neighbors"
date: "December 28, 2015"
categories: ['statistics', 'machine learning']
---

* TOC
{:toc}



# K Nearest Neighbors
The k nearest neighbors method assigns a point based on its k nearest neighbors.

* The distance metric is defined by the user (common methods include Euclidian distance, Manhattan distance, correlation metrics, etc)
* Parameter k found via cross-validation
* Technique becomes more flexible as k decreases

## KNN Classification
Algorithm:

* Find the k nearest neighbors (based on distance)
* Compute the class probabilities based on those neighbors

$$ P(Y = j \vert X = x_0) = \frac{1}{K} \Sigma_{i \in N_0} I(y_i = j) $$

* Assigns the test point to the class with the greatest probability

## KNN Regression
Algorithm:

* Find the k nearest neighbors (based on distance)
* Compute the predicted response

$$ \hat{f}(x_0) = \frac{1}{K} \Sigma_{x_i \in N_0} y_i $$

## Example

Here we run a KNN on two dimensions where the response is binary. The true boundary is given by the black line. The shaded regions are the predicted assignments.

Here we see that the smaller $$K$$ is, the more flexible the predicted boundary line. As we increase $$K$$, the predicted boundary is more linear. 
<img src="/nhuyhoa/figure/source/2015-12-28-ML-KNN/unnamed-chunk-2-1.png" title="plot of chunk unnamed-chunk-2" alt="plot of chunk unnamed-chunk-2" style="display: block; margin: auto;" />

When $$K = 2$$, the test error is minimized and the predicted boundaries are quite similar to the true boundary.
<img src="/nhuyhoa/figure/source/2015-12-28-ML-KNN/unnamed-chunk-3-1.png" title="plot of chunk unnamed-chunk-3" alt="plot of chunk unnamed-chunk-3" style="display: block; margin: auto;" />

## Strengths and Weaknesses

Strengths:

* Simple method
* Can work well in some situations

Weaknesses:

* Fails when the number of features is large (curse of dimensionality) because nearest neighbors may be very far away

# In R

* KNN classification: `class::knn()` or `caret::knn3()`
* KNN regression: `caret::knnreg()`
