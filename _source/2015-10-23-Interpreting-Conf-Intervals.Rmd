---
layout: post
title: "Interpreting Confidence Intervals"
date: "October 23, 2015"
categories: ['statistics', 'other']
---

* TOC
{:toc}

```{r global opts, echo = FALSE, warning = FALSE}
library(jn.general)
lib(data, viz)
knitr::opts_chunk$set(fig.width = 5, fig.height = 5, fig.align = 'center')
```

Confidence intervals are used to convey the amount of uncertainty associated with a sample estimate of a population parameter. Data is collected and the results are used to generate a point estimate and a confidence interval. How does one interpret the confidence interval?

Say we generated a $$(1 - \alpha) 100$$% confidence interval. This interval means that if we were to replicate the data collection and analysis process many times, $$(1 - \alpha) 100$$% of the generated intervals would contain the true value of the population parameter. 

```{r, echo = FALSE}
set.seed(22)
btn <- Vectorize(between)
# create the data
x <- data.frame(id = factor(1:100), center = rnorm(100), width = runif(100, 0.25, 2))
x <- x %>% 
  mutate(
    lower = center - width,
    upper = center + width,
    flag = ifelse( btn(0, lower, upper), "no_color", "color" )
  )

# edits to generate the 95%
y <- to_be(x, subset, flag == "color")
edit <- y$to_be
no_edit <- y$not_to_be

# only keep 5 outside of 0 bars
n <- nrow(edit) - 5
keep <- edit[1:5, ]
more_keep <- sample_n(no_edit, n, replace = TRUE)

# combine all data together
final_data <- list(no_edit, keep, more_keep) %>% 
  rbindlist %>% 
  sample_n(., nrow(.)) %>% 
  mutate(id = 1:nrow(.))
```

Say the true value of $$\mu = 0$$. Here we see, per the definition above, that $$95/100$$ intervals contain the true value of $$\mu$$. 

```{r, echo = FALSE}
# make the plot
ggplot(data = final_data, aes(x = id, ymax = lower, ymin = upper, color = flag)) + 
  geom_errorbar() + 
  # add the baseline
  geom_hline(yintercept = 0, linetype = 2, alpha = 0.75) + 
  # color the bars
  scale_colour_manual(limits = c("color", "no_color"), values = c("red", "grey50")) + 
  # x scale
  xlab("") + scale_x_discrete(breaks = NULL) +
  # remove legend position
  theme(legend.position = "none") +
  # flip the coordinates
  coord_flip() +
  # title
  ggtitle("95% Confidence Interval Simulation")
```

It is important to note that the true value of the population parameter is fixed, so any single confidence interval will either contain the population parameter or not. Thus we cannot interpret the confidence interval as the probability that the true value is in the interval. 

So say we want to test a null hypothesis that $$\mu = 0$$ with a 95% confidence interval. If $$\mu$$ falls within that confidence interval, we say that if we were to repeat the process many times, $$95$$% of the time $$\mu$$ will fall inside the confidence intervals. Thus we can conclude that our data does not indicate a significant difference from $$\mu = 0$$. 