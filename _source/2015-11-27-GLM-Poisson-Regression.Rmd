---
layout: post
title: "GLM: Poisson Regression"
date: "November 27, 2015"
categories: statistics
---

* TOC
{:toc}

```{r, echo = FALSE, message = FALSE}
library(jn.general)
lib(data, viz)
knitr::opts_chunk$set(fig.width = 5, fig.height = 5, fig.align = 'center')
library(faraway)
data(gala)
g <- gala[,-2]
data(dicentric)
dicentric$dosef <- factor(dicentric$doseamt)
```

# Count Response
Suppose the response $$Y_i$$ ~ $$Pois(\mu_i)$$ where $$\mu > 0$$ and the $$Y_i$$ are independent
$$P(Y_i = y_i) = \frac{e^{\mu_i} \mu_i^{y_i}}{y_i!} \forall y_i = 0, 1, ... $$

We also have $$E(Y_i) = Var(Y_i) = \mu_i$$

From this we can compute the deviance
$$ D = 2 \Sigma^n_{i = 1} \big[ y_i log \left( \frac{y_i}{\hat{\mu}_i} \right)  - (y_i - \hat{\mu}_i) \big] $$

We face a problem when our response variable has a Poisson distribution. 

* $$Var(Y) = \mu$$, which is not constant
* $$\mu > 0$$: but OLS may predict values less than zero

To alleviate these concerns, we can use a link function $$\eta_i = g(\mu) = log(\mu)$$ such that $$g^{-1}(\eta) > 0$$ $$\forall \eta$$.

Several instances can be classified as Poisson:

* Count is some number out of some possible total, response is binomial. Poisson is good approximation if success probability is small
* If the probability of an event occuring in a given time interval is proportional to the length of that time interval and independent of other events. The number of events in any specified time interval is Poisson
* When the time between events is independent and identically exponentially distributed. The count of events in a given time period is Poisson

# Poisson Regression Model

## Modeling Counts
We fit the model
$$ log(\mu) = \beta_0 + \beta_1 x_1 + ... + \beta_k x_k$$

We can fit this model in R like so
```{r, eval = FALSE}
glm(Species ~ ., data = g, family = poisson)
```

## Modeling Ratios
If we have ratios and the proportions are small, we can use Poisson regression rather than logistic regression. We fit the model
$$log \left( \frac{count}{total} \right) = \beta_0 + \beta_1 x_1 + ... \beta_k x_k$$
$$ log(count) = log(total) + \beta_0 + \beta_1 x_1 + ... \beta_k x_k $$

We can fit this model in R like so
```{r, eval = FALSE}
glm(ca ~ offset(log(cells)) + log(doserate)*dosef, family = poisson, data = dicentric)
```
The function `offset()` means to not fit a coefficient to a term (or set the coefficient to 1). In this model $$total = cells$$.

# Beta Coefficients

## Interpretation of Coefficients
Interpretation of coefficients is similar to the logistic regression case. Holding all other predictors constant, a unit increase in $$x_i$$ increases the count by a factor of $$exp(\hat{\beta}_i)$$

